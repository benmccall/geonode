{% extends "page_layout.html" %}
{% load i18n %}

{% block title %} {% trans "Welcome!" %} - {{ block.super }} {% endblock %}
{% block indexclass %} class="here" {% endblock %}

{% block head %} 
{% include "geonode/ext_header.html" %}
{{ block.super }}
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}nivo-slider/themes/default/default.css" media="screen" />
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}nivo-slider/nivo-slider.css" media="screen" />
<link rel="stylesheet" type="text/css" href="{{ STATIC_URL }}joyride/joyride-2.0.3.css">
<script type="text/javascript">
Ext.onReady(function(){
{% autoescape off %}

  var exploreMapButton = new Ext.Button({
     renderTo: 'explore_data', 
     text: '<strong>Explore Data</strong>',
     margins: '0 4 4 0',
     scale: 'large',
     width: 80,
     handler: function(){ window.location = "{% url data_search %}"; }
  });

  {% if perms.maps.add_layer %}
  var createMapButton = new Ext.Button({
     renderTo: 'upload_data', 
     text: '<strong>Upload Data</strong>',
     margins: '0 4 4 0',
     scale: 'large',
     width: 80,
     handler: function(){ window.location = "{% url data_upload %}"; }
  });
  {% endif %}

  var submitForm = function() {
     if (searchInput.isValid())
          Ext.query('#data_block form')[0].submit();
  };

  var searchButton = new Ext.Button({
     renderTo: 'submit_search',
     text: '<strong>Search</strong>',
     margins: '0 4 4 0',
     scale: 'large',
     width: 60,
     handler: submitForm});

  var searchInput = new Ext.form.TextField({
     applyTo: 'search_query',
     emptyText: 'Search for GIS Data',
     allowBlank: false,
     style: { 'font-size': '1.75em', 'font-weight': '600' },
     height: 37,
     width: 650});

{% endautoescape %}
});

</script>
{% endblock %}

{% block main %} 
<div class="onecol">
<!-- TODO: i18n on the text here -->
  <div class="block">

    <div class="slider-wrapper theme-default">
        <div id="slider" class="nivoSlider">
            <img src="{{ STATIC_URL }}/theme/img/slide01.jpg" alt="" title="#htmlcaption01" />
            <img src="{{ STATIC_URL }}/theme/img/slide02.jpg" alt="" title="#htmlcaption02" />
            <img src="{{ STATIC_URL }}/theme/img/slide03.jpg" alt="" title="#htmlcaption03" />
            <img src="{{ STATIC_URL }}/theme/img/slide04.jpg" alt="" title="#htmlcaption04" />
            <img src="{{ STATIC_URL }}/theme/img/slide05.jpg" alt="" title="#htmlcaption05" />
            <img src="{{ STATIC_URL }}/theme/img/slide06.jpg" alt="" title="#htmlcaption06" />
        </div>
        <div id="htmlcaption01" class="nivo-html-caption">
            <div class="nivo-caption-01 nivo-caption-box">
                <h2>Welcome!</h2>
                <p>Thank you for visiting the<br/> St. Louis Regional Data Exchange!</p>
            </div>
        </div>
        <div id="htmlcaption02" class="nivo-html-caption">
            <div class="nivo-caption-02 nivo-caption-box">
                <h3>Our Goal?</h3>
                <p>to provide <strong>broad access</strong> to <br/> <strong>valuable data</strong> and <br/> <strong>online mapping</strong> capabilities <br/> for the St. Louis region.</p>
            </div>
        </div>
        <div id="htmlcaption03" class="nivo-html-caption">
            <div class="nivo-caption-03 nivo-caption-box">
                <h3>Our Audience?</h3>
                <p>The STLRDX aims to be a ready data resource for academics, non-profits, community officials, GIS specialists and interested citizens.</p>
            </div>
        </div>
        <div id="htmlcaption04" class="nivo-html-caption">
            <div class="nivo-caption-04 nivo-caption-box">
                <h2>Publish</h2>
                <p>Not only does the STLRDX allow you to access and interact with existing datasets, data owners/creators can <a href="{% url data_upload %}">upload their data</a> to share.</p>
            </div>
            
        </div>
        <div id="htmlcaption05" class="nivo-html-caption">
            <div class="nivo-caption-05 nivo-caption-box">
                <h2>Share</h2>
                <p>If you have data that you would like to share with others in the region, please help us with our effort to make data more accessible by <a href="{% url data_upload %}">uploading it</a>.</p>
            </div>
        </div>
        <div id="htmlcaption06" class="nivo-html-caption">
            <div class="nivo-caption-06 nivo-caption-box">
                <h2>Get Started!</h2>
                <p>Browse GIS Datasets, Interactive Maps, or Map Documents to see what the STLRDX has to offer, today!</p>
            </div>
        </div>
    </div>

  </div>
  <div id="data_block" class="block">
    <!-- Data search text box and button -->

    <form action="{% url data_search %}" method="GET">
        <table>
          <tr>
            <td>
              <input type="text" id="search_query" name="q" />
            </td>
            <td>
              <div id="submit_search" class="content-button"></div>
            </td>
            <td>
              <div id="explore_data" class="content-button"></div>
            </td>

            {% if perms.maps.add_layer %}
            <td>
              <div id="upload_data" class="content-button"></div>
            </td>
            {% endif %}
          </tr>
        </table>

    </form>

  </div>

  <div id="credit_block" class="block">
    The Regional Data Exchange was created by the <a href="http://arc.umsl.edu/" target="_blank">Applied Research Consortium</a>, 
    a collaboration between researchers at <a href="http://www.slu.edu/" target="_blank">Saint Louis University</a>,
    the <a href="http://www.umsl.edu/" target="_blank">University of Missouri - St. Louis</a>, and
    <a href="http://www.siue.edu/" target="_blank">Southern Illinois University at Edwardsville</a>, as part of the 
    <a href="http://www.ewgateway.org/rpsd/" target="_blank">Regional Plan for Sustainable Development</a>; a project made possible
    by a U.S. Department of Housing and Urban Development grant received by the
    <a href="http://www.ewgateway.org/" target="_blank">East-West Gateway Council of Governments</a>.
  </div>

</div>
{% endblock %}

{% block end_body_js %}

  <ol id="tourContent" style="display:none">
    <li data-id="dataLink" data-button="Next: Searching">
      <p>Explore GIS Datasets (layers) that data professionals from the St. Louis region have uploaded to the Data Exchange to share.</p>
      <p>You can view this data online or download it in a variety of file formats.</p>
    </li>
    <li data-id="search_query" data-button="Next: Interactive Maps" data-options="tipLocation:top">
      <p>You can quickly search for GIS Datasets by keywords from the home page.</p>
    </li>
    <li data-id="mapsLink" data-button="Next: Map Documents">
      <p>Users of the Data Exchange (just like you!) have created Interactive Maps that combine GIS Datasets and customized layer styles to share.</p>
      <p>Explore other users' Interactive Maps or create your own, using layers from the Data Exchange and/or other online GIS servers.</p>
    </li>
    <li data-id="documentLink" data-button="Next: Create an Account" data-options="tipLocation:bottom">
      <p>Looking for a pre-made map image or PDF? The Map Documents section of the site allows users to view and share noninteractive maps.</p>
    </li>
    <li data-id="registerLink" data-button="Next: Additional Help">
      <p>In order to save your own Interactive Maps or to upload Map Documents, you'll need a Data Exchange user account.</p>
	  <p>Click the Register link to create one today!</p>
    </li>
    <li data-id="helpLink" data-button="Close">
      <p>If you need additional help, you can access additional instructions and FAQ's from the Help menu at the top of every page.</p>
      <p><strong>Welcome to the St. Louis Regional Data Exchange!</strong></p>
    </li>
  </ol>

<script type="text/javascript" src="{{ STATIC_URL }}nivo-slider/jquery.nivo.slider.pack.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}jquery.cookie.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}modernizr.mq.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}joyride/jquery.joyride-2.0.3.js"></script>
<script type="text/javascript" src="{{ STATIC_URL }}easy.notification.js"></script>
<script type="text/javascript">
//<![CDATA[

function startTour(){
	// hide the notification bar first so the position of the page is correct for joyride
	$('#easyNotification').hide();
	// fade the nivo slider out or it is hard to distinguish between the tour and the slider content
	$('#slider').fadeTo(0, .25);
	// initiate the joyride tour. when the tour ends, set the opacity of the slider back to normal
	$('#tourContent').joyride({
		'postRideCallback': function(){
			$('#slider').fadeTo(0, 1);
		},
	});
	return false;
}

// on document ready
$(document).ready(function() {
	$.easyNotification({
		cookieEnable: true,
		cookieValue: '1',
		cookieDays: 3650,
		autoClose: true,
		duration: 30000,
		text: "New to the St. Louis Regional Data Exchange? <a href=\"#\" onclick=\" return startTour();\">Take a quick tour!</a>"
	}); 
});

// on window load
$(window).load(function() {
	$('#slider').nivoSlider({ effect: 'fade', controlNav: false, pauseTime: 7500, slideshowEnd: function(){ $('#slider').data('nivoslider').stop(); } });
});

//]]>
</script>
{% endblock %}
